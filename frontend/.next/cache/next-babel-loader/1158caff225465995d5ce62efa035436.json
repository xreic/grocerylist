{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"F:\\\\Work\\\\Projects\\\\Grocery List\\\\frontend\\\\components\\\\GroceryList.js\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\n// Dependnencies\nimport { useContext, useEffect } from 'react';\nimport { useMutation, useQuery } from '@apollo/react-hooks'; // Helpers\n\nimport { USERS_ITEMS_QUERY } from '../lib/apollo/queries';\nimport { REMOVE_ITEM_MUTATION } from '../lib/apollo/mutations';\nimport { doctorError } from '../lib/doctorError'; // Styles\n\nimport { Box, Button, Heading, SimpleGrid, Stack, useToast } from '@chakra-ui/core'; // React\n\nimport Item from './Item';\nimport Loading from './Loading';\nimport { ShoppingContext } from '../lib/React/ShoppingContext';\n\nvar GroceryList = function GroceryList() {\n  _s();\n\n  var _data$currentUserItem;\n\n  // Hooks + Contexts\n  var toast = useToast();\n\n  var _useContext = useContext(ShoppingContext),\n      isShopping = _useContext.isShopping,\n      setIsShopping = _useContext.setIsShopping; // Apollo\n\n\n  var _useQuery = useQuery(USERS_ITEMS_QUERY),\n      data = _useQuery.data,\n      loading = _useQuery.loading,\n      error = _useQuery.error;\n\n  var _useMutation = useMutation(REMOVE_ITEM_MUTATION),\n      _useMutation2 = _slicedToArray(_useMutation, 2),\n      deleteItem = _useMutation2[0],\n      deleteResponse = _useMutation2[1]; // Handlers\n\n\n  var handleClick = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(id) {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return deleteItem({\n                variables: {\n                  input: {\n                    id: id\n                  }\n                },\n                optimisticResponse: {\n                  __typename: 'Mutation',\n                  deleteItem: {\n                    item: {\n                      id: id\n                    }\n                  }\n                },\n                update: function update(cache, _ref2) {\n                  var deleteItem = _ref2.data.deleteItem;\n\n                  var _cache$readQuery = cache.readQuery({\n                    query: USERS_ITEMS_QUERY\n                  }),\n                      currentUserItems = _cache$readQuery.currentUserItems;\n\n                  var nodes = currentUserItems.nodes;\n                  var id = deleteItem.item.id;\n                  cache.writeQuery({\n                    query: USERS_ITEMS_QUERY,\n                    data: {\n                      currentUserItems: {\n                        nodes: nodes.filter(function (node) {\n                          return node.id !== id;\n                        })\n                      }\n                    }\n                  });\n                }\n              });\n\n            case 3:\n              _context.next = 7;\n              break;\n\n            case 5:\n              _context.prev = 5;\n              _context.t0 = _context[\"catch\"](0);\n\n            case 7:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 5]]);\n    }));\n\n    return function handleClick(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  if (error || deleteResponse.error) {\n    if (!!error) {\n      toast({\n        description: error,\n        status: 'error',\n        duration: 9001,\n        isClosable: true\n      });\n    }\n\n    if (!!deleteResponse.error) {\n      toast({\n        description: doctorError(deleteResponse.error.message),\n        status: 'error',\n        duration: 9001,\n        isClosable: true\n      });\n    }\n  }\n\n  if (loading) return __jsx(Loading, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 23\n    }\n  });\n\n  if ((_data$currentUserItem = data.currentUserItems) === null || _data$currentUserItem === void 0 ? void 0 : _data$currentUserItem.nodes.length) {\n    var list = data.currentUserItems.nodes;\n    return __jsx(React.Fragment, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 7\n      }\n    }, __jsx(Button, {\n      variantColor: \"blue\",\n      \"aria-label\": \"Checkout the selected items\",\n      alignSelf: \"center\",\n      width: \"35%\",\n      maxWidth: \"300px\",\n      marginBottom: \"2rem\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 9\n      }\n    }, \"Checkout\"), __jsx(Stack, {\n      width: \"60%\",\n      maxWidth: \"500px\",\n      minWidth: \"300px\",\n      margin: \"auto\",\n      spacing: \"0.5rem\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }\n    }, __jsx(SimpleGrid, {\n      columns: \"3\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 11\n      }\n    }, __jsx(Heading, {\n      as: \"h4\",\n      size: \"lg\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 13\n      }\n    }, \"Item\"), __jsx(Heading, {\n      as: \"h4\",\n      size: \"lg\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    }, \"Quantity\")), __jsx(Box, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 11\n      }\n    }, list.map(function (item) {\n      return __jsx(Item, {\n        key: item.id + item.product,\n        id: item.id,\n        product: item.product,\n        quantity: item.quantity,\n        handleClick: handleClick,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 15\n        }\n      });\n    }))));\n  } else {\n    return __jsx(Heading, {\n      as: \"h4\",\n      size: \"lg\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 7\n      }\n    }, \"Remember to add to your list. \\uD83D\\uDCDD\");\n  }\n};\n\n_s(GroceryList, \"AbZKCgD4qqGDyTlzHxZbv2uHTAQ=\", false, function () {\n  return [useToast, useQuery, useMutation];\n});\n\n_c = GroceryList;\nexport default GroceryList;\n\nvar _c;\n\n$RefreshReg$(_c, \"GroceryList\");","map":{"version":3,"sources":["F:/Work/Projects/Grocery List/frontend/components/GroceryList.js"],"names":["useContext","useEffect","useMutation","useQuery","USERS_ITEMS_QUERY","REMOVE_ITEM_MUTATION","doctorError","Box","Button","Heading","SimpleGrid","Stack","useToast","Item","Loading","ShoppingContext","GroceryList","toast","isShopping","setIsShopping","data","loading","error","deleteItem","deleteResponse","handleClick","id","variables","input","optimisticResponse","__typename","item","update","cache","readQuery","query","currentUserItems","nodes","writeQuery","filter","node","description","status","duration","isClosable","message","length","list","map","product","quantity"],"mappings":"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","sourcesContent":["// Dependnencies\nimport { useContext, useEffect } from 'react';\nimport { useMutation, useQuery } from '@apollo/react-hooks';\n\n// Helpers\nimport { USERS_ITEMS_QUERY } from '../lib/apollo/queries';\nimport { REMOVE_ITEM_MUTATION } from '../lib/apollo/mutations';\nimport { doctorError } from '../lib/doctorError';\n\n// Styles\nimport {\n  Box,\n  Button,\n  Heading,\n  SimpleGrid,\n  Stack,\n  useToast\n} from '@chakra-ui/core';\n\n// React\nimport Item from './Item';\nimport Loading from './Loading';\nimport { ShoppingContext } from '../lib/React/ShoppingContext';\n\nconst GroceryList = () => {\n  // Hooks + Contexts\n  const toast = useToast();\n  const { isShopping, setIsShopping } = useContext(ShoppingContext);\n\n  // Apollo\n  const { data, loading, error } = useQuery(USERS_ITEMS_QUERY);\n  const [deleteItem, deleteResponse] = useMutation(REMOVE_ITEM_MUTATION);\n\n  // Handlers\n  const handleClick = async (id) => {\n    try {\n      await deleteItem({\n        variables: { input: { id } },\n        optimisticResponse: {\n          __typename: 'Mutation',\n          deleteItem: {\n            item: { id }\n          }\n        },\n        update: (cache, { data: { deleteItem } }) => {\n          const { currentUserItems } = cache.readQuery({\n            query: USERS_ITEMS_QUERY\n          });\n          const { nodes } = currentUserItems;\n          const { id } = deleteItem.item;\n\n          cache.writeQuery({\n            query: USERS_ITEMS_QUERY,\n            data: {\n              currentUserItems: {\n                nodes: nodes.filter((node) => node.id !== id)\n              }\n            }\n          });\n        }\n      });\n    } catch (error) {\n      // need to catch the error, so a popup doesn't show up\n    }\n  };\n\n  if (error || deleteResponse.error) {\n    if (!!error) {\n      toast({\n        description: error,\n        status: 'error',\n        duration: 9001,\n        isClosable: true\n      });\n    }\n\n    if (!!deleteResponse.error) {\n      toast({\n        description: doctorError(deleteResponse.error.message),\n        status: 'error',\n        duration: 9001,\n        isClosable: true\n      });\n    }\n  }\n\n  if (loading) return <Loading />;\n\n  if (data.currentUserItems?.nodes.length) {\n    const list = data.currentUserItems.nodes;\n\n    return (\n      <React.Fragment>\n        <Button\n          variantColor=\"blue\"\n          aria-label={`Checkout the selected items`}\n          alignSelf=\"center\"\n          width=\"35%\"\n          maxWidth=\"300px\"\n          marginBottom=\"2rem\"\n        >\n          Checkout\n        </Button>\n        <Stack\n          width=\"60%\"\n          maxWidth=\"500px\"\n          minWidth=\"300px\"\n          margin=\"auto\"\n          spacing=\"0.5rem\"\n        >\n          <SimpleGrid columns=\"3\">\n            <Heading as=\"h4\" size=\"lg\">\n              Item\n            </Heading>\n            <Heading as=\"h4\" size=\"lg\">\n              Quantity\n            </Heading>\n          </SimpleGrid>\n          <Box>\n            {list.map((item) => (\n              <Item\n                key={item.id + item.product}\n                id={item.id}\n                product={item.product}\n                quantity={item.quantity}\n                handleClick={handleClick}\n              />\n            ))}\n          </Box>\n        </Stack>\n      </React.Fragment>\n    );\n  } else {\n    return (\n      <Heading as=\"h4\" size=\"lg\">\n        Remember to add to your list. üìù\n      </Heading>\n    );\n  }\n};\n\nexport default GroceryList;\n"]},"metadata":{},"sourceType":"module"}