{"ast":null,"code":"var _jsxFileName = \"F:\\\\Work\\\\Projects\\\\Grocery List\\\\frontend\\\\components\\\\GroceryList.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n// Dependnencies\nimport { useEffect, useState } from 'react';\nimport { useMutation, useQuery } from '@apollo/react-hooks'; // Helpers\n\nimport { USERS_ITEMS_QUERY } from '../lib/apollo/queries';\nimport { REMOVE_ITEM_MUTATION } from '../lib/apollo/mutations';\nimport { doctorError } from '../lib/doctorError'; // Styles\n\nimport { Heading, Skeleton, SimpleGrid, Stack, useToast, Text } from '@chakra-ui/core'; // Components\n\nimport Item from './Item';\n\nconst GroceryList = () => {\n  var _data$currentUser;\n\n  // Hooks\n  const toast = useToast();\n  const {\n    0: dummy,\n    1: setdummy\n  } = useState(initialState); // Apollo\n\n  const {\n    data,\n    loading,\n    error\n  } = useQuery(USERS_ITEMS_QUERY);\n  const [deleteItem, deleteResponse] = useMutation(REMOVE_ITEM_MUTATION); // Handlers\n\n  const handleClick = async id => {\n    try {\n      await deleteItem({\n        variables: {\n          input: {\n            id\n          }\n        },\n        optimisticResponse: {\n          __typename: 'Mutation',\n          deleteItem: {\n            item: {\n              id\n            }\n          }\n        },\n        update: (cache, {\n          data: {\n            deleteItem\n          }\n        }) => {\n          const {\n            currentUser\n          } = cache.readQuery({\n            query: USERS_ITEMS_QUERY\n          });\n          const {\n            nodes\n          } = currentUser.itemsByOwnerId;\n          const {\n            id\n          } = deleteItem.item;\n          cache.writeQuery({\n            query: USERS_ITEMS_QUERY,\n            data: {\n              currentUser: {\n                itemsByOwnerId: {\n                  nodes: nodes.filter(node => node.id !== id)\n                }\n              }\n            }\n          });\n        }\n      });\n    } catch (error) {// need to catch the error, so a popup doesn't show up\n    }\n  };\n\n  if (error || deleteResponse.error) {\n    if (!!error) {\n      toast({\n        description: error,\n        status: 'error',\n        duration: 9001,\n        isClosable: true\n      });\n    }\n\n    if (!!deleteResponse.error) {\n      toast({\n        description: doctorError(deleteResponse.error.message),\n        status: 'error',\n        duration: 9001,\n        isClosable: true\n      });\n    }\n  }\n\n  if (loading) return __jsx(Stack, {\n    width: \"60%\",\n    maxWidth: \"500px\",\n    minWidth: \"300px\",\n    margin: \"auto\",\n    spacing: \"0.5rem\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 7\n    }\n  }, __jsx(Heading, {\n    as: \"h4\",\n    size: \"lg\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 9\n    }\n  }, \"Loading\"), __jsx(Skeleton, {\n    borderRadius: \"1rem\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 9\n    }\n  }, \"Placeholder\"), __jsx(Skeleton, {\n    borderRadius: \"1rem\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }\n  }, \"Placeholder\"), __jsx(Skeleton, {\n    borderRadius: \"1rem\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }\n  }, \"Placeholder\"), __jsx(Skeleton, {\n    borderRadius: \"1rem\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }\n  }, \"Placeholder\"));\n\n  if ((_data$currentUser = data.currentUser) === null || _data$currentUser === void 0 ? void 0 : _data$currentUser.itemsByOwnerId.nodes.length) {\n    const list = data.currentUser.itemsByOwnerId.nodes;\n    return __jsx(Stack, {\n      width: \"60%\",\n      maxWidth: \"500px\",\n      minWidth: \"300px\",\n      margin: \"auto\",\n      spacing: \"0.5rem\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 7\n      }\n    }, __jsx(SimpleGrid, {\n      columns: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }\n    }, __jsx(Heading, {\n      as: \"h4\",\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 11\n      }\n    }, \"Item\"), __jsx(Heading, {\n      as: \"h4\",\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 11\n      }\n    }, \"Quantity\"), __jsx(Text, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 11\n      }\n    })), __jsx(SimpleGrid, {\n      columns: \"3\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }\n    }, list.map(item => __jsx(Item, {\n      key: item.id + item.product,\n      id: item.id,\n      product: item.product,\n      quantity: item.quantity,\n      handleClick: handleClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 13\n      }\n    }))));\n  } else {\n    return __jsx(Heading, {\n      as: \"h4\",\n      size: \"lg\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 7\n      }\n    }, \"Remember to add to your list. \\uD83D\\uDCDD\");\n  }\n};\n\nexport default GroceryList;","map":{"version":3,"sources":["F:/Work/Projects/Grocery List/frontend/components/GroceryList.js"],"names":["useEffect","useState","useMutation","useQuery","USERS_ITEMS_QUERY","REMOVE_ITEM_MUTATION","doctorError","Heading","Skeleton","SimpleGrid","Stack","useToast","Text","Item","GroceryList","toast","dummy","setdummy","initialState","data","loading","error","deleteItem","deleteResponse","handleClick","id","variables","input","optimisticResponse","__typename","item","update","cache","currentUser","readQuery","query","nodes","itemsByOwnerId","writeQuery","filter","node","description","status","duration","isClosable","message","length","list","map","product","quantity"],"mappings":"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","sourcesContent":["// Dependnencies\nimport { useEffect, useState } from 'react';\nimport { useMutation, useQuery } from '@apollo/react-hooks';\n\n// Helpers\nimport { USERS_ITEMS_QUERY } from '../lib/apollo/queries';\nimport { REMOVE_ITEM_MUTATION } from '../lib/apollo/mutations';\nimport { doctorError } from '../lib/doctorError';\n\n// Styles\nimport {\n  Heading,\n  Skeleton,\n  SimpleGrid,\n  Stack,\n  useToast,\n  Text\n} from '@chakra-ui/core';\n\n// Components\nimport Item from './Item';\n\nconst GroceryList = () => {\n  // Hooks\n  const toast = useToast();\n  const [dummy, setdummy] = useState(initialState)\n\n\n  // Apollo\n  const { data, loading, error } = useQuery(USERS_ITEMS_QUERY);\n  const [deleteItem, deleteResponse] = useMutation(REMOVE_ITEM_MUTATION);\n\n  // Handlers\n  const handleClick = async (id) => {\n    try {\n      await deleteItem({\n        variables: { input: { id } },\n        optimisticResponse: {\n          __typename: 'Mutation',\n          deleteItem: {\n            item: { id }\n          }\n        },\n        update: (cache, { data: { deleteItem } }) => {\n          const { currentUser } = cache.readQuery({ query: USERS_ITEMS_QUERY });\n          const { nodes } = currentUser.itemsByOwnerId;\n          const { id } = deleteItem.item;\n\n          cache.writeQuery({\n            query: USERS_ITEMS_QUERY,\n            data: {\n              currentUser: {\n                itemsByOwnerId: {\n                  nodes: nodes.filter((node) => node.id !== id)\n                }\n              }\n            }\n          });\n        }\n      });\n    } catch (error) {\n      // need to catch the error, so a popup doesn't show up\n    }\n  };\n\n  if (error || deleteResponse.error) {\n    if (!!error) {\n      toast({\n        description: error,\n        status: 'error',\n        duration: 9001,\n        isClosable: true\n      });\n    }\n\n    if (!!deleteResponse.error) {\n      toast({\n        description: doctorError(deleteResponse.error.message),\n        status: 'error',\n        duration: 9001,\n        isClosable: true\n      });\n    }\n  }\n\n  if (loading)\n    return (\n      <Stack\n        width=\"60%\"\n        maxWidth=\"500px\"\n        minWidth=\"300px\"\n        margin=\"auto\"\n        spacing=\"0.5rem\"\n      >\n        <Heading as=\"h4\" size=\"lg\">\n          Loading\n        </Heading>\n        <Skeleton borderRadius=\"1rem\">Placeholder</Skeleton>\n        <Skeleton borderRadius=\"1rem\">Placeholder</Skeleton>\n        <Skeleton borderRadius=\"1rem\">Placeholder</Skeleton>\n        <Skeleton borderRadius=\"1rem\">Placeholder</Skeleton>\n      </Stack>\n    );\n\n  if (data.currentUser?.itemsByOwnerId.nodes.length) {\n    const list = data.currentUser.itemsByOwnerId.nodes;\n\n    return (\n      <Stack\n        width=\"60%\"\n        maxWidth=\"500px\"\n        minWidth=\"300px\"\n        margin=\"auto\"\n        spacing=\"0.5rem\"\n      >\n        <SimpleGrid columns=\"3\">\n          <Heading as=\"h4\" size=\"lg\">\n            Item\n          </Heading>\n          <Heading as=\"h4\" size=\"lg\">\n            Quantity\n          </Heading>\n          <Text></Text>\n        </SimpleGrid>\n        <SimpleGrid columns=\"3\">\n          {list.map((item) => (\n            <Item\n              key={item.id + item.product}\n              id={item.id}\n              product={item.product}\n              quantity={item.quantity}\n              handleClick={handleClick}\n            />\n          ))}\n        </SimpleGrid>\n      </Stack>\n    );\n  } else {\n    return (\n      <Heading as=\"h4\" size=\"lg\">\n        Remember to add to your list. 📝\n      </Heading>\n    );\n  }\n};\n\nexport default GroceryList;\n"]},"metadata":{},"sourceType":"module"}